# リグ打 運用マニュアル

## 目次

1. [管理画面へのアクセス](#管理画面へのアクセス)
2. [ワード管理](#ワード管理)
3. [カテゴリ管理](#カテゴリ管理)
4. [CSVインポート](#csvインポート)
5. [ランキング管理](#ランキング管理)
6. [Supabaseでの直接操作](#supabaseでの直接操作)
7. [トラブルシューティング](#トラブルシューティング)

---

## 管理画面へのアクセス

### URL

```
https://[your-domain]/admin
```

### ログイン

1. 管理画面URLにアクセス
2. ログイン画面が表示される
3. 管理者IDとパスワードを入力
4. 「ログイン」ボタンをクリック

### ログアウト

画面右上の「ログアウト」をクリック

---

## ワード管理

管理画面の「ワード管理」タブで操作します。

### ワードの追加

1. 「ワードを追加」ボタンをクリック
2. 以下の項目を入力：
   - **テキスト**: 画面に表示される文字（例：寿司、function）
   - **ふりがな**: 入力する文字（例：すし、function）
   - **入力タイプ**:
     - ひらがな: 日本語入力
     - アルファベット: 英字入力
   - **カテゴリ**: 所属カテゴリを選択
   - **重み設定**: 難易度ごとの出現頻度（0〜10）
     - 0: その難易度では出現しない
     - 数値が大きいほど出現しやすい
3. 「保存」ボタンをクリック

### ワードの編集

1. ワード一覧から編集したいワードの「編集」ボタンをクリック
2. 内容を修正
3. 「保存」ボタンをクリック

### ワードの削除

1. ワード一覧から削除したいワードの「削除」ボタンをクリック
2. 確認ダイアログで「OK」をクリック

### ワードの一括削除

1. 削除したいワードのチェックボックスを選択
2. 「選択したワードを削除」ボタンをクリック
3. 確認ダイアログで「OK」をクリック

---

## カテゴリ管理

管理画面の「カテゴリ管理」タブで操作します。

### カテゴリの追加

1. 「カテゴリを追加」ボタンをクリック
2. 以下の項目を入力：
   - **カテゴリ名**: 表示名（例：IT用語、ビジネス）
   - **説明**: カテゴリの説明文
3. 「保存」ボタンをクリック

### カテゴリの編集

1. カテゴリ一覧から編集したいカテゴリの「編集」ボタンをクリック
2. 内容を修正
3. 「保存」ボタンをクリック

### カテゴリの削除

1. カテゴリ一覧から削除したいカテゴリの「削除」ボタンをクリック
2. 確認ダイアログで「OK」をクリック

**注意**: カテゴリを削除すると、そのカテゴリに属するワードは「一般」カテゴリに移動されます。

---

## CSVインポート

管理画面の「CSVインポート」タブで操作します。

### CSVフォーマット

```csv
テキスト,ふりがな,入力タイプ,カテゴリ,易,普,難
寿司,すし,hiragana,一般,2,1,0
container,container,alphabet,IT用語,0,1,2
```

| 列 | 内容 | 必須 | 備考 |
|----|------|------|------|
| 1 | テキスト | ○ | 画面表示用 |
| 2 | ふりがな | ○ | 入力用 |
| 3 | 入力タイプ | - | hiragana / alphabet（省略時: hiragana）|
| 4 | カテゴリ | - | カテゴリ名またはID（省略時: default）|
| 5 | かんたん重み | - | 0〜10（省略時: 1）|
| 6 | ふつう重み | - | 0〜10（省略時: 1）|
| 7 | むずかしい重み | - | 0〜10（省略時: 1）|

### インポート手順

1. 「CSVインポート」タブを開く
2. CSVファイルを選択（またはドラッグ＆ドロップ）
3. プレビュー画面で内容を確認
   - 緑のチェック: 有効なデータ
   - 赤のバツ: エラーのあるデータ（インポートされません）
4. 「○件をインポート」ボタンをクリック
5. インポート完了後、自動的にワード管理画面に遷移

---

## ランキング管理

管理画面の「ランキング管理」タブで操作します。

### ランキングのリセット

1. 「ランキング管理」タブを開く
2. 現在のランキング件数を確認
3. 「ランキングをリセット」ボタンをクリック
4. 確認メッセージが表示される
5. 「リセットする」ボタンをクリック

**注意**: この操作は取り消せません。全ての難易度のランキングが削除されます。

---

## Supabaseでの直接操作

緊急時やバッチ処理が必要な場合、Supabaseダッシュボードから直接操作できます。

### アクセス方法

1. [Supabase](https://supabase.com/) にログイン
2. プロジェクトを選択
3. 左メニューの「Table Editor」をクリック

### テーブル一覧

| テーブル名 | 用途 |
|-----------|------|
| Ranking | ランキングデータ |
| Category | カテゴリマスタ |
| Word | ワードマスタ |

### SQLでの一括操作

「SQL Editor」タブから直接SQLを実行できます。

**例: 特定カテゴリのワードを全削除**
```sql
DELETE FROM "Word" WHERE "categoryId" = 'カテゴリID';
```

**例: ランキングの古いデータを削除**
```sql
DELETE FROM "Ranking" WHERE "createdAt" < '2024-01-01';
```

**例: ワードの重みを一括更新**
```sql
UPDATE "Word" SET "weightHard" = 2 WHERE "categoryId" = 'it';
```

### バックアップ

1. Supabaseダッシュボードの「Settings」→「Database」
2. 「Backups」セクションでバックアップを管理

---

## トラブルシューティング

### 管理画面にログインできない

1. IDとパスワードが正しいか確認
2. Caps Lockがオンになっていないか確認
3. ブラウザのキャッシュをクリア
4. 別のブラウザで試す

### ワードが保存できない

1. 必須項目（テキスト、ふりがな、カテゴリ）が入力されているか確認
2. カテゴリが存在するか確認
3. ブラウザのコンソールでエラーを確認

### CSVインポートでエラーが出る

1. ファイル形式がCSV（.csv）であることを確認
2. 文字コードがUTF-8であることを確認
3. 各行に最低2列（テキスト、ふりがな）があることを確認
4. カテゴリ名が正しいか確認

### ゲーム画面でワードが表示されない

1. ワードが登録されているか確認
2. 選択したカテゴリにワードがあるか確認
3. 選択した難易度の重みが0でないか確認
4. ブラウザをリロード

### データベースに接続できない

1. Supabaseダッシュボードでプロジェクトの状態を確認
2. 環境変数（DATABASE_URL）が正しいか確認
3. Supabaseのプロジェクトが一時停止していないか確認

### ランキングが更新されない

1. ゲーム終了時にニックネームを入力したか確認
2. ブラウザのネットワークタブでAPIエラーを確認
3. データベース接続を確認

---

## 連絡先

問題が解決しない場合は、開発チームにお問い合わせください。
